## Demo 2 Setup.

In this section, we will repeat many of the steps from the previous section but in the context of a Web API (or Web Service) that uses a Postgres database server for its persistence layer. The API supports CRUD operations on a set of tables for managing the allocation of employees to teams in an organisation. The API is also developed on a Javascript, Node and Express platform for convenience. Clone this repository:
~~~bash
$ git clone
~~~
Import the project into VS Code and type the command:
~~~bash
$ npm install
~~~
Download the images related to the Postgres database server and run them inside containers:
~~~bash
$ docker pull postgres:13
$ docker pull dpage/pgadmin4:8.7.    (PostGress admin web application)
$ docker run -d  --name postgres \
    -p 5432:5432  \
    -e POSTGRES_PASSWORD=pass1234 \
    -e POSTGRES_DB=postgres \
    postgres:13
$ docker run -d --name pgadmin4 \
     -p 5050:80  \
    -e PGADMIN_DEFAULT_EMAIL=admin@email.com  \
    -e PGADMIN_DEFAULT_PASSWORD=pass5678 \
dpage/pgadmin4:8.7
~~~
Each container is assigned an IP address (by Docker) to facilitate network communication. Type the command:
~~~bash
$ docker ps
~~~
From the list displayed, copy the ID of the Postgres container and type the command:
~~~bash
$  docker inspect containedID   

e.g.
$  docker inspect 1d354f0d0120   
~~~
From the JSON response, copy the IPAddress value in the Network section - see the example below:
~~~json
 "Networks": {
    "bridge": {
        "IPAMConfig": null,
        "Links": null,
        "Aliases": null,
        "NetworkID": "b2b3779f12031de8bd5dd1f7486c29e872e488ddbc74f312b82d54d46e0f06c9",
        "EndpointID": "e73941617e31b23fd13681a56854d998614d99278866520eac5b64d1fe0f394a",
        "Gateway": "172.17.0.1",
        "IPAddress": "172.17.0.2",  (Copy this IP address)
        "IPPrefixLen": 16,
        "IPv6Gateway": "",
        "GlobalIPv6Address": "",
        "GlobalIPv6PrefixLen": 0,
        "MacAddress": "02:42:ac:11:00:02",
        "DriverOpts": null
}
~~~
To connect the Postgres Admin web application to the Postgres Database, follow these steps:
1. Open a web browser tab at http://localhost:5050.
1. Log in to the app using the credentials we specified when starting the PGAdmin container, i.e., Email = admin@email.com and Password = pass5678.
1. Click the Add New Server link in the Quick Links section of the web page.
1. Enter EmployeeMgt as the server's name (arbitrary).
1. Select the Connection tab.
1. Enter the IP address of the Postgres container as the Host Name/address.
1. Enter postgres as the username.
1. Enter pass1234 as the password.
1. Click the Save button.

A new server called EmployeeMgt should appear in the left panel of the web page. Expand this server and expand its Databases list. There is one database called postgres, which we want to initialize. Right-click the postgres database and select Query Tool. In the Query text box that appears on the right, copy the SQL statements from the `script.sql` file in the VS Code project, and click the Execute Script icon. This has created three tables in the database: employee, employee-assignment, and teams. To confirm this, on the left panel expand Databases --> postgres --> Schemas --> Public --> Tables.   ``

In VS Code, start the web API:
~~~bash
$ node index.js
~~~
This Web API has excellent inbuilt documentation generated by the [Swagger framework][swg] - not really a part of this module's focus. To view it, open a new browser tab at http://localhost:5000/api-docs/. Follow these steps to test the API:

1. Click the POST /employee section to expand it.
1. Click the Try it Out button on the right and click the Execute button. This request was processed by the API and resulted in the addition of a record to the employee database table. 
1. To confirm it, scroll down the documentation page, and expand the GET /employee section.
1. Click the Try It Out button, and click the Execute button. The response should show the list of employees (currently only one) retrieved by the API from the database.

In future labs, we will use this web API to demonstrate other aspects of the Docker platform. For simplicity, we will refer to it as the __Employee Manahement API__.

[swg]: https://swagger.io/