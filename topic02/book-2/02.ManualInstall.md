## Manual Deployment.

We will first __manually__ deploy this app to the AWS EC2 cloud service and then apply a CI/CD pipeline to automate any subsequent deployments of updates to the game. 

Log in to your AWS account using a browser tab. We refer to this website as the AWS Management Console. In the Management Console, type EC2 in the search box in the page header and select the EC2 service in the list of matches. First, we want to create a public/private key pair to facilitate SSH communication later in this lab. Follow these steps:

1. Select Key Pairs in the left panel (under Network & Security)
1. Click the Create key pair button on the top right.
1. Enter cicdpair for the name.
1. Select RSA as the type.
1. Select .pem as the file format.
1. Click the Create key pair button.

A file named `cicdpair.pem` has been downloaded to your computer. It contains the private key of this key pair. You will need this file later. 

We can now create an EC2 virtual machine instance to host our dockerized game application. Follow these steps in the Management Console:

1. Click Instances (under Instances) on the left panel.
1. Click the Launch Instance button on the top right.
1. Enter DockerHost for the Launch template name.
1. In the Application and OS Images section,  under the Quick Start, select Amazon Linux
1. In the Instance type section, choose t2.micro as the type.
1. In the Key pair section, select cicdpair from the dropdown list.
1. In the Networking section, choose Create Security group and tick Allow SSH, Allow HTTP, and Allow HTTPS.
1. Scroll to the bottom of the page and click the Launch Instance button.

Refresh the web page, and the new EC2 instance named DockerHost should appear in the list of instances. Select the instance and copy the public IPv4 address assigned to it for later use.  

We want to install the Docker platform on the EC2 instance by connecting to it remotely and manually installing it from the command line. On your laptop, open an ordinary terminal window and use the cd command to switch to the folder that contains the `cicdpair.pem` file. 

------------------------------
Note: If you are working on a Mac OSX laptop, change the pem file's permissions before using ssh, as follows:
~~~bash
$ chmod 0400 ec2tutorial.pem
~~~
------------------------------

Use the SSH utility to connect to your EC2 instance as follows:
~~~bash
$ ssh -i cicdpair.pem  ec2-user@ec2_IP_address
e.g.  ssh -i ec2cdk.pem  ec2-user@34.244.156.17
~~~
Type the following commands at the command prompt of the EC2 instance:
~~~bash
sudo yum update -y
sudo yum install docker -y
sudo systemctl start docker
sudo docker run hello-world    #  Default Docker Hub test image
sudo docker ps
sudo docker images
sudo systemctl enable docker
sudo usermod -a -G docker $(whoami)
docker run -d -p 80:80 --name 2048game myHubUsername2048game:1.0.    
# Use your Docker Hub username in the previous command.
~~~

The last command above started a docker container to run your 2048 game image. In a new browser tab, navigate to the game using your EC2's IP address, e.g. http://18.201.141.214/


[game]: https://play.google.com/store/apps/details?id=com.estoty.game2048&hl=en